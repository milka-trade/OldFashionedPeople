"""
========================================================================
키움증권 산업별 주도주 자동매매 시스템 - 설정 파일
========================================================================
상업용 수준의 포트폴리오 관리 + 트레일링 스탑 매도 전략
========================================================================
"""

# ============================================================
# 1. 계좌 설정
# ============================================================
ACCOUNT_NO = ""  # 키움 계좌번호 (로그인 후 자동 세팅)
ACCOUNT_PASSWORD = ""  # 계좌 비밀번호
IS_REAL_SERVER = False  # True: 실서버, False: 모의투자

# ============================================================
# 2. 산업(업종) 분류 코드 - 키움 업종 코드 기준
# ============================================================
SECTOR_CODES = {
    "반도체": "027",       # 반도체와반도체장비
    "2차전지": "266",      # 이차전지
    "바이오": "033",       # 제약
    "자동차": "018",       # 자동차와부품
    "IT": "032",           # IT가전
    "금융": "021",         # 은행
    "건설": "012",         # 건설
    "화학": "007",         # 화학
    "철강": "009",         # 철강과금속
    "유통": "023",         # 유통업
    "엔터": "036",         # 미디어와엔터
    "방산": "015",         # 기계
    "AI/소프트웨어": "034", # 소프트웨어
    "통신": "031",         # 통신서비스
    "에너지": "010",       # 전기가스업
}

# ============================================================
# 3. 포트폴리오 구성 전략
# ============================================================
MAX_SECTORS = 8               # 최대 투자 섹터 수
STOCKS_PER_SECTOR = 1         # 섹터당 주도주 수
MAX_PORTFOLIO_SIZE = 8        # 최대 보유 종목 수
MAX_WEIGHT_PER_STOCK = 0.15   # 종목당 최대 비중 (15%)
MIN_WEIGHT_PER_STOCK = 0.05   # 종목당 최소 비중 (5%)
TOTAL_INVESTMENT_RATIO = 0.90 # 총 자산 대비 투자 비율 (90%, 10%는 현금)

# ============================================================
# 4. 주도주 스크리닝 기준 (가중치)
# ============================================================
SCREENING_WEIGHTS = {
    "volume_rank": 0.25,          # 거래대금 순위 (높을수록 좋음)
    "price_change_rank": 0.20,    # 등락률 순위
    "foreign_buy_rank": 0.20,     # 외국인 순매수 순위
    "institution_buy_rank": 0.15, # 기관 순매수 순위
    "market_cap_rank": 0.10,      # 시가총액 순위
    "turnover_rank": 0.10,        # 회전율 순위
}

# 스크리닝 필터 (최소 조건)
MIN_MARKET_CAP = 5000           # 최소 시가총액 (억원)
MIN_TRADING_VOLUME = 50         # 최소 거래대금 (억원)
MIN_PRICE = 1000                # 최소 주가 (원)
EXCLUDE_ADMIN_STOCKS = True     # 관리종목 제외
EXCLUDE_ETF = True              # ETF 제외

# ============================================================
# 5. 매수 전략
# ============================================================
BUY_START_TIME = "090500"       # 매수 시작 시각 (09:05 - 동시호가 이후)
BUY_END_TIME = "093000"         # 매수 마감 시각 (09:30까지)
BUY_ORDER_TYPE = "03"           # 시장가 매수
BUY_SPLIT_COUNT = 3             # 분할 매수 횟수
BUY_SPLIT_INTERVAL = 60         # 분할 매수 간격 (초)

# ============================================================
# 6. 매도 전략 (트레일링 스탑 - 당일 최고가 추적)
# ============================================================
TRAILING_STOP_PERCENT = 0.02    # 고점 대비 2% 하락 시 매도
PROFIT_TARGET_PERCENT = 0.05    # 목표 수익률 5% 도달 시 트레일링 강화
ENHANCED_TRAILING_STOP = 0.01   # 목표 도달 후 1% 트레일링
STOP_LOSS_PERCENT = -0.03       # 손절매 라인 -3%
SELL_ORDER_TYPE = "03"          # 시장가 매도
FORCE_SELL_TIME = "152000"      # 강제 청산 시각 (15:20)
SELL_START_TIME = "091000"      # 매도 감시 시작 (09:10)

# ============================================================
# 7. 리스크 관리
# ============================================================
MAX_DAILY_LOSS_PERCENT = -0.05  # 일일 최대 손실 -5%
MAX_SINGLE_LOSS = -0.03         # 단일 종목 최대 손실 -3%
EMERGENCY_STOP = False          # 긴급 정지 플래그

# ============================================================
# 8. 운영 스케줄
# ============================================================
SCHEDULE = {
    "screening": "0830",         # 주도주 스크리닝 시각
    "rebalance_start": "0900",   # 리밸런싱(매수) 시작
    "rebalance_end": "0930",     # 리밸런싱 완료 시한
    "monitoring_start": "0910",  # 매도 모니터링 시작
    "force_sell": "1520",        # 강제 청산
    "market_close": "1530",      # 장마감
    "daily_report": "1600",      # 일일 리포트 생성
}

# ============================================================
# 9. 로그 및 데이터 저장
# ============================================================
LOG_DIR = "./logs"
DATA_DIR = "./data"
REPORT_DIR = "./reports"
DB_PATH = "./data/trading.db"
LOG_LEVEL = "INFO"

# ============================================================
# 10. 실시간 데이터 수신 FID
# ============================================================
REAL_TIME_FIDS = {
    "현재가": 10,
    "전일대비": 11,
    "등락율": 12,
    "누적거래량": 13,
    "누적거래대금": 14,
    "시가": 16,
    "고가": 17,
    "저가": 18,
    "거래량": 15,
    "체결시간": 20,
}
